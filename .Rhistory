library(terra)
library(sf)
bio1 <- raster("source/bio1_23.bil")
library(terra)
library(sf)
bio1 <- raster("source/bio1_23.bil")
bio1 <- terra::rast("source/bio1_23.bil")
bio1
caminos <- st_read("source/redcaminos2014crtm05.shp", crs= 5367)
v <- vect(caminos)
roads <- as.lines(v)
rs <- rast(v)
values(rs) <- 1:ncell(rs)
names(rs) <- "rast"
rsp <- as.polygons(rs)
rp <- intersect(roads, rsp)
rp$length <- perim(rp) / 1000 #km
x <- tapply(rp$length, rp$rast, sum)
Dencaminos <- rast(rs)
Dencaminos[as.integer(names(x))] <- as.vector(x)
plot(Dencaminos)
Dencaminos
bio1
DencaminosF <- resample(Dencaminos, bio1)
DencaminosF
DencaminosF <- resample(Dencaminos, bio1, method="bilinear")
DencaminosF
Dencaminos
bio1
Dencaminos <- crs(Dencaminos, crs=(bio1))
Dencaminos <- crs(Dencaminos, bio1)
Dencaminos <- project(Dencaminos, bio1)
Dencaminos
bio1
DencaminosF <- resample(Dencaminos, bio1)
DencaminosF
plot(DencaminosF)
plot(bio1)
cr <- st_read("source/bordecr2008polycrtm05.shp")
cr <- st_transform(cr, crs = "WGS84")
cr
bio1 <- crop(bio1, cr)
bio1
plot(bio1)
DencaminosF <- resample(Dencaminos, bio1)
plot(DencaminosF)
writeRaster(DencaminosF, "results/CR_RoadDensity.asc")
plot(DencaminosF)
lines(caminos)
plot(DencaminosF)
lines(caminos)
plot(caminos, add=TRUE)
plot(DencaminosF)
### DENSIDAD DE RIOS###
## Utilizar capa de rios150000 de Atlas2014
rios <- st_read("source/rios1500002014crtm05.shp", crs= 5367)
### DENSIDAD DE RIOS###
## Utilizar capa de rios150000 de Atlas2014
rios <- st_read("source/rios150000crtm05.shp", crs= 5367)
rios
v1 <- vect(rios)
roads1 <- as.lines(v1)
rs1 <- rast(v1)
values(rs1) <- 1:ncell(rs1)
names(rs1) <- "rast"
rsp1 <- as.polygons(rs1)
rp1 <- intersect(roads1, rsp1)
rp1
rsp1
v1 <- vect(rios)
rios1 <- as.lines(v1)
rs1 <- rast(v1)
rs1
values(rs1) <- 1:ncell(rs1)
names(rs1) <- "rast"
rsp1 <- as.polygons(rs1)
rp1 <- intersect(roads1, rsp1)
rp1 <- intersect(rios1, rsp1)
rios1
rsp1
rs
rsp
rp
rs1
rsp1
plor(rios1)
plot(rios1)
plot(rsp1)
plor(rsp)
plot(rsp)
rp1 <- intersect(rios1, rsp1)
library(raster)
library(maptools)
library(rgeos)
library(rgdal)
library(sf)
rios<-readOGR("source/rios150000crtm05.shp", crs= 5367, sep="")
rios<-readOGR("source/rios150000crtm05.shp", sep="") # abrir mapa carreteras
rios<-readOGR("source/rios150000crtm05.shp") # abrir mapa carreteras
rios
grid<-raster("source/bio1_23.tif")
grid
x11()
plot(grid) #  graficar grilla
lines(rios,add=T)
rios <- st_transform(rios, crs = "WGS84")
lines(rios,add=T) #  graficar catastro
proj4string(rios) = CRS("+init=epsg:5367") # establecer CRS del catastro
proj4string(grid) = CRS("+init=epsg:5367")  # establecer CRS de grid
rios.lineas<-as(rios, "SpatialLines") #convertir catastro en SpatialLines
rios.lineas # verificar la transformaci?n
grid
rios_pn <-st_crop(rios, grid)
rios_pn <-crop(rios, grid)
gClip <- function(shp, bb){
if(class(bb) == "matrix") b_poly <- as(extent(as.vector(t(bb))), "SpatialPolygons")
else b_poly <- as(extent(bb), "SpatialPolygons")
gIntersection(shp, b_poly, byid = T)
}
l<-numeric()
for(i in 1:ncell(grid)){
tmp_rst <- grid
tmp_rst[] <- 0
tmp_rst[i] <- 1
tmp_shp <- rasterToPolygons(tmp_rst)
tmp_shp
#plot(tmp_rst)
tmp_shp=subset(tmp_shp, grid2x2==1)# change according with grid size
if (gIntersects(rios.lineas, tmp_shp)) {
catas_clip<-gClip(rios.lineas, tmp_shp)
#lines(catas_clip)
catas_clip_length <- gLength(catas_clip)
length<-catas_clip_length
} else {
length=0
}
l<-append(l, length)
}
l<-numeric()
for(i in 1:ncell(grid)){
tmp_rst <- grid
tmp_rst[] <- 0
tmp_rst[i] <- 1
tmp_shp <- rasterToPolygons(tmp_rst)
tmp_shp
#plot(tmp_rst)
tmp_shp=subset(tmp_shp, grid==1)# change according with grid size
if (gIntersects(rios.lineas, tmp_shp)) {
catas_clip<-gClip(rios.lineas, tmp_shp)
#lines(catas_clip)
catas_clip_length <- gLength(catas_clip)
length<-catas_clip_length
} else {
length=0
}
l<-append(l, length)
}
library(terra)
library(sf)
pn <- st_read("source/pn_range_WGS84.shp")
grilla <- st_read("source/Grilla_1x1.shp")
plot(grilla$geometry)
grillapn <- st_crop(grilla, pn)
grilla <- st_transform(grilla, crs = "WGS84")
grilla
pn
grillapn <- st_crop(grilla, pn)
plot(grillapn$geometry)
grillapn <-mask(grilla, pn)
grillapn <-st_mask(grilla, pn)
plot(pn$geometry, add=TRUE)
plot(pn$geometry)
library(terra)
library(sf)
rios <- st_read("source/rios150000crtm05.shp", crs= 5367)
v1 <- vect(rios)
rios1 <- as.lines(v1)
rs1 <- rast(v1)
values(rs1) <- 1:ncell(rs1)
names(rs1) <- "rast"
rsp1 <- as.polygons(rs1)
rp1 <- intersect(rios1, rsp1)
plot(rios1)
plot(rsp1, add=TRUE)
rsp1
rsp
library(terra)
library(sf)
## Utilizar la variables Bio1 de WoldClim como referencia para la resoluciÃ³n
bio1 <- terra::rast("source/bio1_23.bil")
cr <- st_read("source/bordecr2008polycrtm05.shp")
cr <- st_transform(cr, crs = "WGS84")
bio1 <- crop(bio1, cr)
### DENSIDAD DE CAMINOS###
## Utilizar capa de caminos de Atlas2014
caminos <- st_read("source/redcaminos2014crtm05.shp", crs= 5367)
v <- vect(caminos)
roads <- as.lines(v)
rs <- rast(v)
values(rs) <- 1:ncell(rs)
names(rs) <- "rast"
rsp <- as.polygons(rs)
rp <- intersect(roads, rsp)
rp$length <- perim(rp) / 1000 #km
x <- tapply(rp$length, rp$rast, sum)
Dencaminos <- rast(rs)
Dencaminos[as.integer(names(x))] <- as.vector(x)
Dencaminos <- project(Dencaminos, bio1)
DencaminosF <- resample(Dencaminos, bio1)
rsp
rsp1
roads
rios1
caminos
v1
v
v1 <- vect(rios, what= "")
v1 <- vect(rios,what = " ")
v1 <- vect(rios, query = "SELECT LONGITUD")
v1 <- terra::vect(rios, query = "SELECT LONGITUD")
library(terra)
library(sf)
v1 <- terra::vect(rios, atts= d)
v1 <- terra::vect(rios, atts= LONGITUD)
v1 <- terra::vect(rios, atts= "LONGITUD")
rios
v1 <- vect(rios, atts= "NOMBRE")
v1 <- vect(rios)
v1
rios
### DENSIDAD DE RIOS###
## Utilizar capa de rios150000 de Atlas2014
rios <- st_read("source/CR_RiosOSM.shp")
rios
v1 <- vect(rios)
rios1 <- as.lines(v1)
rs1 <- rast(v1)
values(rs1) <- 1:ncell(rs1)
names(rs1) <- "rast"
rsp1 <- as.polygons(rs1)
rp1 <- intersect(rios1, rsp1)
rp1$length <- perim(rp1) / 1000 #km
x1 <- tapply(rp1$length, rp1$rast, sum)
rios <- rast(rs1)
rios[as.integer(names(x1))] <- as.vector(x1)
rios1 <- rast(rs1)
rios1[as.integer(names(x1))] <- as.vector(x1)
plot(rios1)
riosF <- resample(Denrios, bio1)
riosF <- resample(rios1, bio1)
plot(riosF)
ruisF <- crop(riosR, bio1)
ruisF <- crop(riosF, bio1)
riosF <- crop(riosF, bio1)
plot(bio1)
riosF <- mask(riosF, bio1)
plot(riosF)
writeRaster(riosF, "results/CR_RiosDensity.asc")
library(terra)
library(sf)
bio1 <- terra::rast("source/bio1_23.bil")
cr <- st_read("source/bordecr2008polycrtm05.shp")
cr <- st_transform(cr, crs = "WGS84")
bio1 <- crop(bio1, cr)
### DENSIDAD DE RIOS###
## Utilizar capa de rios150000 de Atlas2014
rios <- st_read("source/CR_RiosOSM.shp")
v1 <- vect(rios)
rios1 <- as.lines(v1)
rs1 <- rast(v1)
values(rs1) <- 1:ncell(rs1)
names(rs1) <- "rast"
rsp1 <- as.polygons(rs1)
rp1 <- intersect(rios1, rsp1)
rp1$length <- perim(rp1) / 1000 #km
x1 <- tapply(rp1$length, rp1$rast, sum)
rios1 <- rast(rs1)
rios1[as.integer(names(x1))] <- as.vector(x1)
riosF <- resample(rios1, bio1)
riosF <- crop(riosF, bio1)
riosF <- mask(riosF, bio1)
plot(riosF)
writeRaster(riosF, "results/CR_RiosDensity.asc")
writeRaster(riosF, "results/CR_RiosDensity.asc",overwrite=TRUE)
